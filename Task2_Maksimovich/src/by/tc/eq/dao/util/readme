У вас в задаче не было условия использования пула соединени
+ я говорила, берете код из нета - 1000 раз думайте, 
ибо идею его создателя, особенно если она ошибочна и вы не все элементы используемые в коде вообще понимаете,
нужно постигать долго
а еще и ошибки править
